{"ast":null,"code":"import _objectSpread from\"C:/Users/grave/apds7311-secure-portal/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import api from'../api/axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const emailPattern=/^\\S+@\\S+\\.\\S+$/;export default function Login(){const[form,setForm]=useState({email:'',password:''});const[errors,setErrors]=useState({});const[message,setMessage]=useState('');const[loading,setLoading]=useState(false);const navigate=useNavigate();function handleChange(e){setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[e.target.name]:''}));}function validate(){const errs={};if(!emailPattern.test(form.email))errs.email='Enter a valid email.';if(!form.password)errs.password='Password is required.';setErrors(errs);return Object.keys(errs).length===0;}async function handleSubmit(e){e.preventDefault();setMessage('');if(!validate())return;setLoading(true);try{var _res$data;const res=await api.post('/login',form);const token=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.token;if(token){localStorage.setItem('token',token);setMessage('Login successful.');navigate('/payment');}else{var _res$data2;setMessage((res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.message)||'Login succeeded (no token returned).');}}catch(err){setMessage('Login failed: '+((err===null||err===void 0?void 0:err.message)||JSON.stringify(err)));}finally{setLoading(false);}}return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:420},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,noValidate:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{name:\"email\",value:form.email,onChange:handleChange}),errors.email&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:form.password,onChange:handleChange}),errors.password&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errors.password})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:loading?'Logging in...':'Login'})})]}),message&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:message})]});}","map":{"version":3,"names":["React","useState","api","useNavigate","jsx","_jsx","jsxs","_jsxs","emailPattern","Login","form","setForm","email","password","errors","setErrors","message","setMessage","loading","setLoading","navigate","handleChange","e","_objectSpread","target","name","value","prev","validate","errs","test","Object","keys","length","handleSubmit","preventDefault","_res$data","res","post","token","data","localStorage","setItem","_res$data2","err","JSON","stringify","style","maxWidth","children","onSubmit","noValidate","className","onChange","type","marginTop","disabled"],"sources":["C:/Users/grave/apds7311-secure-portal/client/src/pages/Login.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport api from '../api/axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst emailPattern = /^\\S+@\\S+\\.\\S+$/;\r\n\r\nexport default function Login() {\r\n  const [form, setForm] = useState({ email: '', password: '' });\r\n  const [errors, setErrors] = useState({});\r\n  const [message, setMessage] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  function handleChange(e) {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n    setErrors(prev => ({ ...prev, [e.target.name]: '' }));\r\n  }\r\n\r\n  function validate() {\r\n    const errs = {};\r\n    if (!emailPattern.test(form.email)) errs.email = 'Enter a valid email.';\r\n    if (!form.password) errs.password = 'Password is required.';\r\n    setErrors(errs);\r\n    return Object.keys(errs).length === 0;\r\n  }\r\n\r\n  async function handleSubmit(e) {\r\n    e.preventDefault();\r\n    setMessage('');\r\n    if (!validate()) return;\r\n    setLoading(true);\r\n    try {\r\n      const res = await api.post('/login', form);\r\n      const token = res?.data?.token;\r\n      if (token) {\r\n        localStorage.setItem('token', token);\r\n        setMessage('Login successful.');\r\n        navigate('/payment');\r\n      } else {\r\n        setMessage(res?.data?.message || 'Login succeeded (no token returned).');\r\n      }\r\n    } catch (err) {\r\n      setMessage('Login failed: ' + (err?.message || JSON.stringify(err)));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div style={{ maxWidth: 420 }}>\r\n      <h3>Login</h3>\r\n      <form onSubmit={handleSubmit} noValidate>\r\n        <div className=\"form-row\">\r\n          <label>Email</label>\r\n          <input name=\"email\" value={form.email} onChange={handleChange} />\r\n          {errors.email && <div className=\"error\">{errors.email}</div>}\r\n        </div>\r\n\r\n        <div className=\"form-row\">\r\n          <label>Password</label>\r\n          <input type=\"password\" name=\"password\" value={form.password} onChange={handleChange} />\r\n          {errors.password && <div className=\"error\">{errors.password}</div>}\r\n        </div>\r\n\r\n        <div style={{ marginTop: 12 }}>\r\n          <button type=\"submit\" disabled={loading}>{loading ? 'Logging in...' : 'Login'}</button>\r\n        </div>\r\n      </form>\r\n\r\n      {message && <div style={{ marginTop: 12 }}>{message}</div>}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}